<!DOCTYPE html>

<html lang="zh-CN" class="mingBackground mingBased">



<head>
    
    <meta charset="utf-8">

    
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta name="author" content="MingMoe & Thanks Octopress">

    
    <title>
Java17æ–°Native APIåˆä½“éªŒ
- MingMoeçš„ç½‘ç»œåšå®¢
    </title>

    
    


<link type="text/css" rel="stylesheet" href="https://blog.kawayi.moe//css/normalize.css">




<link type="text/css" rel="stylesheet" href="https://blog.kawayi.moe/scss/ming.css">


<link type="text/css" rel="stylesheet" href="https://blog.kawayi.moe//css/syntax.css">



<style>    

    
    .mingBackground{
        background: url(/Background.webp);
    }

    
    .mingBased{
        font-size: 16px;
    }

</style>





<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Pacifico&display=swap" rel="stylesheet">

</head>



<body class="mingBody">

    
    
<header class="mingFacade">
    <h1>
        æ¬¢è¿æ¥åˆ°å¤§æ˜é…±çš„ç½‘ç»œåšå®¢ğŸ“š
    </h1>

    <p>
        ä¸€ä¸ªæŠ€æœ¯å®…çš„ç½‘ç»œåšå®¢â”—|ï½€Oâ€²|â”› ~~
    </p>
</header>

    
    

<nav class="mingNav">
    
    <ul>
        
        <li>
            <a href="https://blog.kawayi.moe//">Blog</a>
        </li>

        
        <li>
            <a href="https://blog.kawayi.moe//about">About Me</a>
        </li>

        
        <li>
            <a href="https://blog.kawayi.moe//archives">Archives</a>
        </li>

        
        <li>
            <a href="https://blog.kawayi.moe//categories">Categories</a>
        </li>

        
        <li>
            <a href="https://blog.kawayi.moe//tags">Tags</a>
        </li>

    </ul>

</nav>



<nav class="mingMenu">
    
    <select onchange="location = this.value;">
        
        <option>Navigate</option>
        
        <option value="https://blog.kawayi.moe//">ğŸ”— Blog</option>
        <option value="https://blog.kawayi.moe//about">ğŸ”— About Me</option>
        <option value="https://blog.kawayi.moe//archives">ğŸ”— Archives</option>
        <option value="https://blog.kawayi.moe//categories">ğŸ”— Categories</option>
        <option value="https://blog.kawayi.moe//tags">ğŸ”— Tags</option>
    </select>

</nav>

    
    
    <div class="mingContentWrapper">
        
        <main class="mingContent">
            


<div class="mingPostStyle">
    
    <div class="postHeader">
        
        <p></span> Saturday, January 15, 2022 </span><span> | <a href="/tags/native">native</a></span><span> | <a href="/tags/java">java</a></span></p>
    </div>

    
    <div class="postTitle">
        <h1>Java17æ–°Native APIåˆä½“éªŒ</h1>
    </div>

    
    <div class="postContent">
        <p>æœ€è¿‘åœ¨ä½¿ç”¨Javaç¼–å†™ç¨‹åºï¼Œéœ€è¦å’Œc++è¿›è¡Œäº¤äº’ã€‚æ­£å¥½ç¢°åˆ°äº†Java17æ–°æ·»åŠ çš„Native APIï¼ˆç±»ä¼¼JNIï¼‰ã€‚æ¥è‡ª<a href="https://openjdk.java.net/jeps/412">JEP 412</a>ã€‚</p>
<p>äºæ˜¯å’±æœ¬ç€èˆæˆ‘å…¶è°ï¼Œèº«å…ˆå£«å’ï¼Œæ•¢ä¸ºäººå…ˆï¼Œä¸€ä¸ªé¡¶ä¿©çš„ç²¾ç¥ï¼Œä½¿ç”¨äº†è¿™ä¸ªè¿˜åœ¨å­µåŒ–çš„APIã€‚</p>
<h3 id="åŠ è½½å‡½æ•°">åŠ è½½å‡½æ•°</h3>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œä¸ŠCode:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// éœ€è¦å…ˆåŠ è½½åº“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">System</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="s">&#34;xxx.dll&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CLinker</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CLinker</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MethodHandle</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linker</span><span class="p">.</span><span class="na">downcallHandle</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SymbolLookup</span><span class="p">.</span><span class="na">loaderLookup</span><span class="p">().</span><span class="na">lookup</span><span class="p">(</span><span class="cm">/*ä½ çš„å‡½æ•°åç§°*/</span><span class="p">).</span><span class="na">orElseThrow</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">MethodType</span><span class="p">.</span><span class="na">methodType</span><span class="p">(</span><span class="cm">/*ä½ çš„å‡½æ•°å®šä¹‰*/</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">FunctionDescriptor</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="cm">/*ä½ çš„å‡½æ•°å®šä¹‰*/</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·ï¼Œå°±å¯ä»¥ç®€å•åŠ è½½ä¸€ä¸ªå‡½æ•°äº†ã€‚æˆ‘ä»¬åªéœ€è¦å¯¹è¿”å›çš„å‡½æ•°Hanldeæ‰§è¡Œè°ƒç”¨æ“ä½œå°±è¡Œäº†å“¦ã€‚è®°å¾—å¡«ä¸Šå‚æ•°ï¼Œå‚æ•°å’Œè¿”å›å€¼ç±»å‹åŒ<code>MethodType</code>çš„é‚£ä¸ªå‚æ•°ã€‚ãƒ½(âœ¿ï¾Ÿâ–½ï¾Ÿ)ãƒ</p>
<p>å½“ç„¶ï¼Œåœ¨<code>MethodType.methodType</code>å’Œ<code>FunctionDescriptor.of</code>éœ€è¦å¡«å†™ä½ çš„å‡½æ•°çš„å®šä¹‰ã€‚ä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨è¦å¯¹åº”ã€‚ä¾‹å¦‚:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// è¿™æ®µä»£ç è°ƒç”¨çš„cå‡½æ•°æ¥å£æ˜¯:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// void* ();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å³ä¸€ä¸ªè¿”å›ä»»æ„ç±»å‹æŒ‡é’ˆçš„å‡½æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MethodType</span><span class="p">.</span><span class="na">methodType</span><span class="p">(</span><span class="n">MemoryAddress</span><span class="p">.</span><span class="na">class</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">FunctionDescriptor</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">CLinker</span><span class="p">.</span><span class="na">C_POINTER</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ³¨æ„ï¼ŒMemoryAddress.classå’ŒCLinker.C_POINTERæ˜¯å¯¹åº”å…³ç³»ï¼ˆå³æŒ‡é’ˆç±»å‹ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å¦‚æœä¿®æ”¹ï¼Œå°†ä¼šåœ¨è¿è¡Œæ—¶æŠ¥é”™</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢æœ‰ä¸€ä¸ªå¯¹åº”å…³ç³»è¡¨ï¼Œæ³¨æ„ï¼Œå¦‚æœè¿”å›voidï¼ˆå³æ²¡æœ‰è¿”å›å€¼ï¼‰ï¼Œéœ€è¦ä½¿ç”¨<code>MethodType.methodType(void.class,...)</code>å’Œ<code>FunctionDescriptor.ofVoid(...)</code>æ¥æ›¿ä»£ã€‚</p>
<p>ä¸‹é¢æ˜¯MethodTypeå’ŒFunctionDescriptorçš„å¯¹åº”å…³ç³»è¡¨:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Method Type</th>
          <th style="text-align: center">Function Descriptor</th>
          <th style="text-align: center">C Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">MemoryAddress.class</td>
          <td style="text-align: center">CLinker.C_POINTER</td>
          <td style="text-align: center">ä»»ä½•ç±»å‹çš„æŒ‡é’ˆ</td>
      </tr>
      <tr>
          <td style="text-align: center">long.class</td>
          <td style="text-align: center">CLinker.C_LONG_LONG</td>
          <td style="text-align: center">unsigned long long</td>
      </tr>
      <tr>
          <td style="text-align: center">int.class</td>
          <td style="text-align: center">CLinker.C_INT</td>
          <td style="text-align: center">int</td>
      </tr>
      <tr>
          <td style="text-align: center">short.class</td>
          <td style="text-align: center">CLinker.C_SHORT</td>
          <td style="text-align: center">short</td>
      </tr>
      <tr>
          <td style="text-align: center">ä»¥æ­¤ç±»æ¨ï¼Œè¿˜æœ‰double,charç­‰åŸºæœ¬ç±»å‹</td>
          <td style="text-align: center">none</td>
          <td style="text-align: center">none</td>
      </tr>
  </tbody>
</table>
<h3 id="è§£ææ•°æ®ç»“æ„">è§£ææ•°æ®ç»“æ„</h3>
<p>ä¸ºäº†è§£ææ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªNativeå‡½æ•°è¿”å›ä¸€ä¸ªMemoryAddressï¼šæŒ‡å‘æ•°æ®ç»“æ„ã€‚</p>
<p>ä¸€ä¸ªä¾‹å­:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Bitmap</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">uint32_t</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">uint32_t</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">uint32_t</span> <span class="n">bitmap_left</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">uint32_t</span> <span class="n">bitmap_top</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æŒ‡å‘ä¸€ä¸ªçŸ©å½¢ä½å›¾ï¼Œå¤§å°ç”±xå’Œyå†³å®šã€‚æ¯ä½å ç”¨RGBAå…±4ä¸ªå­—èŠ‚ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">uint8_t</span><span class="o">*</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>parsing in java&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ•°æ®ç»“æ„å®šä¹‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Bitmap</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">bitmapLeft</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">bitmapTop</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è§£æ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Bitmap</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="n">MemoryAddress</span><span class="w"> </span><span class="n">ptr</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å°†æŒ‡é’ˆè½¬åŒ–ä¸ºå¯ä»¥è®¿é—®çš„å†…å­˜æ®µ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">MemorySegment</span><span class="w"> </span><span class="n">segment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">asSegment</span><span class="p">(</span><span class="cm">/*ç»è¿‡æ‰‹å·¥è®¡ç®—ï¼Œç»“æ„ä½“çš„å¤§å°ä½16å­—èŠ‚*/</span><span class="n">16</span><span class="p">,</span><span class="cm">/*ä½¿ç”¨globalScopeéœ€è¦æˆ‘ä»¬è‡ªå·±é‡Šæ”¾å†…å­˜ï¼Œå¦‚æœæƒ³è¦JVMæ¥é‡Šæ”¾ï¼Œå¯ä»¥ä½¿ç”¨newImplicitScopeï¼Œå…·ä½“è§Javaæ–‡æ¡£*/</span><span class="n">ResourceScope</span><span class="p">.</span><span class="na">globalScope</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ ¹æ®ABIç»“æ„å–å‡ºç»“æ„ä½“çš„å˜é‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// MemoryAccessæ˜¯ä¸€ä¸ªè¾…åŠ©ç±»ï¼Œå¯ä»¥ç”¨æ¥è®¿é—®å†…å­˜æ®µ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryAccess</span><span class="p">.</span><span class="na">getIntAtIndex</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryAccess</span><span class="p">.</span><span class="na">getIntAtIndex</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryAccess</span><span class="p">.</span><span class="na">getIntAtIndex</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryAccess</span><span class="p">.</span><span class="na">getIntAtIndex</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryAccess</span><span class="p">.</span><span class="na">getAddressAtOffset</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span><span class="n">16</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¤åˆ¶æ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Bitmap</span><span class="w"> </span><span class="n">bitmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Bitmap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bitmap</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bitmap</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bitmap</span><span class="p">.</span><span class="na">bitmapLeft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">left</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bitmap</span><span class="p">.</span><span class="na">bitmapTop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bitmap</span><span class="p">.</span><span class="na">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">4</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¤åˆ¶Bitmap.dataé‡Œçš„å­—èŠ‚æ•°ç»„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">asSegment</span><span class="p">(</span><span class="cm">/*ä¸ºä»€ä¹ˆè¦ä¹˜ä»¥4ï¼Œå› ä¸ºc++éƒ¨åˆ†çš„ä»£ç å¦‚æ­¤ã€‚æ­¤å¤„å¡«å†™å†…å­˜æ®µå¤§å°ã€‚*/</span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">4</span><span class="p">,</span><span class="n">ResourceScope</span><span class="p">.</span><span class="na">globalScope</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// copy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">segment</span><span class="p">.</span><span class="na">asByteBuffer</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">bitmap</span><span class="p">.</span><span class="na">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bitmap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åç»­">åç»­</h3>
<p>Javaå°†ç»§ç»­å­µåŒ–æ­¤APIã€‚<em>Java Forward Again!</em></p>
    </div>

    
    <div class="postFooter">
        <p>Posted by MingMoe.</p>
        <p>Last update Saturday, January 15, 2022.</p>
    </div>

</div>


        </main>
        
        
        


<aside class="mingSider">

    <p>æ¬¢è¿æ¥åˆ°æœ¬ç«™[]~ï¼ˆï¿£â–½ï¿£ï¼‰~*</p>

    
    <div>
        <iframe style="overflow: hidden;display: flex;width:100%" width="300" height="30" frameborder="0" scrolling="no" hspace="0" src="https://i.tianqi.com/index.php?c=code&id=34&icon=1"></iframe>
    </div>

    
    <div>
        <a class="twitter-timeline" data-lang="zh-cn" data-height="2048" href="https://twitter.com/ming_moe_?ref_src=twsrc%5Etfw"></a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>

</aside>
    </div>

    
    

<footer class="mingFooter">

    <p>Powered by <a href="https://gohugo.io/">Hugo</a>.Copyright Â©  2021-2023 MingMoe.<br>

    <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
        <img alt="çŸ¥è¯†å…±äº«è®¸å¯åè®®" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />æœ¬ä½œå“é‡‡ç”¨<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
            çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®
        </a>è¿›è¡Œè®¸å¯ã€‚

    </p>

</footer>

</body>


</html>
